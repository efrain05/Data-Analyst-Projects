                What do the ids in the status tables mean?

-- Looking up the meaning of order_status ids from address_status table
-- I found that 1 = active and 2 = inactive

SELECT * FROM address_status

-- Lookig up the meaning of order_status ids
--After looking up the meaning I found that id 1 = Order received, 2 = pending delivery, 3 = delivery in progress, 4 = delivered, 5 = cancelled, 6 = returned 
 
 SELECT * FROM order_status

                 How does the order_history table work?


-- Select an order_id from order_history with a status_id corresponding to `Returned`
-- The first order id I found was 4412

SELECT * FROM order_history WHERE status_id = 6 LIMIT 1

-- Select all data in order_history with the order_id I found with the query above.

SELECT * FROM order_history WHERE order_id = 4412 

                       How many errors are returned by users?

-- Counting the amount books returned
-- I found 200 books were returned 

SELECT COUNT(*) FROM order_history WHERE status_id = 6

                      How to join the order_history and cust_order tables?

-- Joining cust_order and order_history table 

SELECT * FROM cust_order
JOIN order_history ON order_history.order_id = cust_order.order_id
WHERE cust_order.order_id = 4412

                    Do a significant number of users return multiple orders?

-I found that multiple customers have returned 2 or more times 

SELECT cust_order.customer_id, COUNT(order_history.order_id) AS returned_orders 
FROM cust_order
JOIN order_history ON order_history.order_id = cust_order.order_id
WHERE order_history.status_id = 6
GROUP BY cust_order.customer_id 
ORDER BY returned_orders DESC

                    Who are the customers returning more orders than usual?

-- Used left join to join customer table to find out customers first name,last name ,and email that has over 2 or more returns 

SELECT customer.first_name,customer.last_name,customer.email,cust_order.customer_id, COUNT(order_history.order_id) AS returned_orders 
FROM cust_order
JOIN order_history ON order_history.order_id = cust_order.order_id
LEFT JOIN customer ON customer.customer_id = cust_order.customer_id
WHERE order_history.status_id = 6
GROUP BY cust_order.customer_id,customer.first_name,customer.last_name,customer.email
HAVING COUNT(order_history.order_id) > 1
ORDER BY returned_orders DESC



